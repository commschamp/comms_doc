<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>COMMS: comms::option::def::CustomValueReader&lt; T &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COMMS
   </div>
   <div id="projectbrief">Template library intended to help with implementation of communication protocols.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecomms.html">comms</a></li><li class="navelem"><a class="el" href="namespacecomms_1_1option.html">option</a></li><li class="navelem"><a class="el" href="namespacecomms_1_1option_1_1def.html">def</a></li><li class="navelem"><a class="el" href="structcomms_1_1option_1_1def_1_1CustomValueReader.html">CustomValueReader</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">comms::option::def::CustomValueReader&lt; T &gt; Struct Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="options_8h_source.html">comms/options.h</a>&quot;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br />
struct comms::option::def::CustomValueReader&lt; T &gt;</h3>

<p>Option that specifies custom value reader class. </p>
<p>It may be useful to override default reading functionality for complex fields, such as <a class="el" href="classcomms_1_1field_1_1Bundle.html" title="Bundles multiple fields into a single field.">comms::field::Bundle</a>, where the way members are read is defined by the values of other members. For example, bundle of two integer fields, the first one is normal, and the second one is optional. The optional mode of the latter is determined by the value of the first field. If its value is 0, than the second member exists, otherwise it's missing. </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classcomms_1_1field_1_1Bundle.html">comms::field::Bundle</a>&lt;</div>
<div class="line">    <a class="code" href="classcomms_1_1Field.html">comms::Field&lt;BigEndianOpt&gt;</a>,</div>
<div class="line">    std::tuple&lt;</div>
<div class="line">        <a class="code" href="classcomms_1_1field_1_1IntValue.html">comms::field::IntValue</a>&lt;</div>
<div class="line">            <a class="code" href="classcomms_1_1Field.html">comms::Field&lt;BigEndianOpt&gt;</a>,</div>
<div class="line">            std::uint8_t</div>
<div class="line">        &gt;,</div>
<div class="line">        <a class="code" href="classcomms_1_1field_1_1Optional.html">comms::field::Optional</a>&lt;</div>
<div class="line">            <a class="code" href="classcomms_1_1field_1_1IntValue.html">comms::field::IntValue</a>&lt;</div>
<div class="line">                <a class="code" href="classcomms_1_1Field.html">comms::Field&lt;BigEndianOpt&gt;</a>,</div>
<div class="line">                std::uint16_t</div>
<div class="line">            &gt;</div>
<div class="line">        &gt;</div>
<div class="line">    &gt;,</div>
<div class="line">    <a class="code" href="structcomms_1_1option_1_1def_1_1CustomValueReader.html">comms::option::CustomValueReader&lt;MyCustomReader&gt;</a></div>
<div class="line">&gt; Field;</div>
</div><!-- fragment --><p> The <b>MyCustomReader</b> custom reading class may implement required functionality of reading the first member, analysing its value, setting appropriate mode for the second one and read the second member.</p>
<p>The custom value reader class provided as template argument must define the following member function: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>MyCustomReader</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TField, <span class="keyword">typename</span> TIter&gt;</div>
<div class="line">    <a class="code" href="namespacecomms.html#a0a259a03d68bce98b4a129fb34aaa2e1">comms::ErrorStatus</a> operator()(TField&amp; field, TIter&amp; iter, std::size_t len) {...}</div>
<div class="line">};</div>
</div><!-- fragment --><p>The custom reader for the example above may be implemented as: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>MyCustomReader</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TField, <span class="keyword">typename</span> TIter&gt;</div>
<div class="line">    <a class="code" href="namespacecomms.html#a0a259a03d68bce98b4a129fb34aaa2e1">comms::ErrorStatus</a> operator()(TField&amp; field, TIter&amp; iter, std::size_t len)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keyword">auto</span>&amp; members = field.value();</div>
<div class="line">        <span class="keyword">auto</span>&amp; first = std::get&lt;0&gt;(members);</div>
<div class="line">        <span class="keyword">auto</span>&amp; second = std::get&lt;1&gt;(members);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> es = first.read(iter, len);</div>
<div class="line">        <span class="keywordflow">if</span> (es != <a class="code" href="namespacecomms.html#a0a259a03d68bce98b4a129fb34aaa2e1a505a83f220c02df2f85c3810cd9ceb38">comms::ErrorStatus::Success</a>) {</div>
<div class="line">            <span class="keywordflow">return</span> es;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (first.value() != 0) {</div>
<div class="line">            second.setMode(<a class="code" href="namespacecomms_1_1field.html#ab1a00acfb597ac892cc9d5a73740ad9ea2aee0be2678ee90fd327cc186826438e">comms::field::OptionalMode::Missing</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            second.setMode(<a class="code" href="namespacecomms_1_1field.html#ab1a00acfb597ac892cc9d5a73740ad9ea2a8eb028670e972535e8e246be645821">comms::field::OptionalMode::Exists</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> second.read(iter, len - first.length());</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --> <dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Type of the custom reader class. </td></tr>
  </table>
  </dd>
</dl>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>include/comms/<a class="el" href="options_8h_source.html">options.h</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclasscomms_1_1field_1_1Optional_html"><div class="ttname"><a href="classcomms_1_1field_1_1Optional.html">comms::field::Optional</a></div><div class="ttdoc">Adaptor class to any other field, that makes the field optional.</div><div class="ttdef"><b>Definition:</b> Optional.h:44</div></div>
<div class="ttc" id="anamespacecomms_1_1field_html_ab1a00acfb597ac892cc9d5a73740ad9ea2aee0be2678ee90fd327cc186826438e"><div class="ttname"><a href="namespacecomms_1_1field.html#ab1a00acfb597ac892cc9d5a73740ad9ea2aee0be2678ee90fd327cc186826438e">comms::field::OptionalMode::Missing</a></div><div class="ttdeci">@ Missing</div><div class="ttdoc">Field doesn't exist.</div></div>
<div class="ttc" id="astructcomms_1_1option_1_1def_1_1CustomValueReader_html"><div class="ttname"><a href="structcomms_1_1option_1_1def_1_1CustomValueReader.html">comms::option::def::CustomValueReader</a></div><div class="ttdoc">Option that specifies custom value reader class.</div><div class="ttdef"><b>Definition:</b> options.h:747</div></div>
<div class="ttc" id="anamespacecomms_html_a0a259a03d68bce98b4a129fb34aaa2e1"><div class="ttname"><a href="namespacecomms.html#a0a259a03d68bce98b4a129fb34aaa2e1">comms::ErrorStatus</a></div><div class="ttdeci">ErrorStatus</div><div class="ttdoc">Error statuses reported by the Communication module.</div><div class="ttdef"><b>Definition:</b> ErrorStatus.h:17</div></div>
<div class="ttc" id="aclasscomms_1_1Field_html"><div class="ttname"><a href="classcomms_1_1Field.html">comms::Field</a></div><div class="ttdoc">Base class to all the field classes.</div><div class="ttdef"><b>Definition:</b> Field.h:32</div></div>
<div class="ttc" id="anamespacecomms_html_a0a259a03d68bce98b4a129fb34aaa2e1a505a83f220c02df2f85c3810cd9ceb38"><div class="ttname"><a href="namespacecomms.html#a0a259a03d68bce98b4a129fb34aaa2e1a505a83f220c02df2f85c3810cd9ceb38">comms::ErrorStatus::Success</a></div><div class="ttdeci">@ Success</div><div class="ttdoc">Used to indicate successful outcome of the operation.</div></div>
<div class="ttc" id="aclasscomms_1_1field_1_1Bundle_html"><div class="ttname"><a href="classcomms_1_1field_1_1Bundle.html">comms::field::Bundle</a></div><div class="ttdoc">Bundles multiple fields into a single field.</div><div class="ttdef"><b>Definition:</b> Bundle.h:75</div></div>
<div class="ttc" id="anamespacecomms_1_1field_html_ab1a00acfb597ac892cc9d5a73740ad9ea2a8eb028670e972535e8e246be645821"><div class="ttname"><a href="namespacecomms_1_1field.html#ab1a00acfb597ac892cc9d5a73740ad9ea2a8eb028670e972535e8e246be645821">comms::field::OptionalMode::Exists</a></div><div class="ttdeci">@ Exists</div><div class="ttdoc">Field must exist.</div></div>
<div class="ttc" id="aclasscomms_1_1field_1_1IntValue_html"><div class="ttname"><a href="classcomms_1_1field_1_1IntValue.html">comms::field::IntValue</a></div><div class="ttdoc">Field that represent integral value.</div><div class="ttdef"><b>Definition:</b> IntValue.h:72</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
